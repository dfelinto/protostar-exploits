package main

import (
	"bytes"
	"testing"
)

func TestStack4Password(t *testing.T) {
	s := stack4{}

	password := s.get_input_data()
	passwordLen := len(password)
	passwordLenExpected := 64 + 24 + 4

	if len(password) != passwordLenExpected {
		t.Errorf("Wrong password length, got: %d, expected: %d", passwordLen, passwordLenExpected)
	}

	passwordData := password[64+24:]
	passwordDataExpected := []byte{
		'\x1d',
		'\x06',
		'\x40',
		'\x00',
	}

	if bytes.Compare(passwordData, passwordDataExpected) != 0 {
		t.Errorf("Wrong password data, expected: %c, got: %c", passwordData, passwordDataExpected)
	}
}
